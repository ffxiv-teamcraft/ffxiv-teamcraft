<nz-list [nzRenderItem]="historyRow" [nzDataSource]="history$ | async">
  <ng-template #historyRow let-entry>
    <nz-list-item [nzActions]="entry.finalItem !== undefined ? [undoTemplate]:[]">
      <nz-list-item-meta [nzTitle]="title" [nzDescription]="description" [nzAvatar]="avatar">
        <ng-template #avatar>
          <app-user-avatar [userId]="entry.userId"></app-user-avatar>
        </ng-template>
        <ng-template
          #title>{{entry.itemId | itemName | i18n}} {{entry.amount > 0 ? '+' : ''}}{{entry.amount}}</ng-template>
        <ng-template #description>
          <div *ngIf="entry.userId !== undefined; else anonymousName">
            {{entry.userId | characterName | async}} - {{entry.date | date: 'short'}}
          </div>
          <ng-template #anonymousName>
            {{'COMMON.Anonymous' | translate}}, {{entry.date | date: 'short'}}
          </ng-template>
        </ng-template>
      </nz-list-item-meta>
      <ng-template #undoTemplate>
        <button nz-button nzShape="circle" nzSize="small" (click)="undo(entry)" nz-tooltip
                [nzTitle]="'COMMON.Undo' | translate">
          <i nz-icon nzType="rollback"></i>
        </button>
      </ng-template>
    </nz-list-item>
  </ng-template>
</nz-list>
